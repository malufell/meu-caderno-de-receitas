<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Caderno de Receitas</title>
    <link rel='stylesheet' href='/styles/main.css' />
    <link rel='stylesheet' href='/styles/receita.css' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/cb9e18acaf.js" crossorigin="anonymous"></script>
</head>

<body>
    <%- include('../views/partials/nav-user.ejs') %>
    <main>

        <div class="container centered">
            <div class="row">
                <div class="col-md-8">

                    <div class="container-fluid d-flex justify-content-center">
                        <div class="row mb-1 mt-2">
                            <h4 class='text-center'><%= receita.nome %></h4>
                        </div>
                    </div>

                    <div class="container-fluid d-flex justify-content-center">
                        <div class="row mb-3">
                            <h5>
                                <% receita.categorias.forEach(function(categoria) { %>
                                    <span class="badge badge-secondary"><%= categoria.categoria %></span>
                                <% }) %>
                            </h5>
                        </div>
                    </div>

                    <% if (receita.imagem) { %>
                    <div class="container-fluid">
                        <div class="row d-flex justify-content-center">
                            <img src="<%= imagem %>" alt="imagem receita" class="img-fluid border rounded-lg imagem-receita">
                        </div>
                    </div>
                   <% } %>


                    <div class="container-fluid mt-3">
                        <div class="row d-flex justify-content-center">
                            <h4>Lista de ingredientes:</h4>
                        </div>
                        <div class="row d-flex justify-content-center mt-3 lista-ingredientes">
                            <p>
                                <%= receita.ingredientes %>
                            </p>
                        </div>
                    </div>

                    <div class="container-fluid mt-3">
                        <div class="row d-flex justify-content-center">
                            <h4>Modo de preparo:</h4>
                        </div>
                        <div class="row d-flex justify-content-center mt-3 lista-ingredientes">
                            <%= receita.preparo %>
                        </div>
                    </div>

                    <div class="container-fluid mt-3">
                        <div class="row d-flex justify-content-center">
                            <h4>O pulo do gato :)</h4>
                        </div>
                        <div class="row d-flex justify-content-center mt-3 lista-ingredientes">
                            <p>
                                <%= receita.dicas %>
                            </p>
                        </div>
                    </div>

                    <% if (receita.video) { %>
                    <div class="container-fluid">
                        <div class="row d-flex justify-content-center mt-5">
                            <h4>Vídeo da receita:</h4>
                        </div>
                            <div class="row d-flex justify-content-center mt-3">
                                <iframe width="560" height="315" src=<%= video %> frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                    </div>
                    <% } %>
                </div>

                <div class="col-md-4">
                    <div class="container-fluid mt-5 pt-5">
                        <div class="mt-3">
                            <i class="fas fa-book"></i>
                            <a href="/receitas">Voltar ao caderno de receitas</a>
                        </div>

                        <div class="mt-3">
                            <i class="far fa-edit"></i>
                            <a href="/receitas/<%= receita.id %>/edicao">Editar receita</a>
                        </div>
                        
                        <div class="mt-3">
                            <i class="far fa-trash-alt"></i>
                            <a href="#" data-toggle="modal" data-target="#modalExclusao">
                                Excluir receita</a>                              
                        </div>               

                        <small>
                            <ul class="list-unstyled mb-0 mt-3">
                                <li class="d-flex mb-2">
                                    <h6 class="mb-0">Última atualização:</h6>
                                    <p class="ml-3 text-muted mb-0"><%=receita.updateAt%></p>
                                </li>
                                <li class="d-flex mb-2">
                                    <h6 class="mb-0">Receita cadastrada em:</h6>
                                    <p class="ml-3 text-muted mb-0"><%=receita.createdAt%></p>
                                </li>
                            </ul>    
                        </small>

                    </div>
                </div>

            </div>
        </div>
        
        <!-- Modal confirmação de exclusão -->
        <div class="modal fade" id="modalExclusao" tabindex="-1" aria-labelledby="modalExclusaoLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="modalExclusaoLabel">Confirmar exclusão</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">
                Tem certeza que deseja excluir a receita <%= receita.nome %>?
                </div>
                <div class="modal-footer">
                    <form method="POST" action="/receitas/<%= receita.id %>/?_method=DELETE">
                        <button class="btn btn-danger" type="submit">Confirmar exclusão</button>
                    </form>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                </div>
            </div>
            </div>
        </div>

    </main>
    <%- include('../views/partials/footer.ejs') %>
</body>
</html>


